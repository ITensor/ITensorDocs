<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/ITensorDocs/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>MPS Time Evolution · ITensors.jl</title><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="https://itensor.github.io/ITensorDocs/ITensors/stable/tutorials/MPSTimeEvolution.html" rel="canonical"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="https://itensor.org"><img alt="home" src="../../../assets/logo-dark.png"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../Overview/">Home</a><a class="nav-link active nav-item" href="../../">ITensors</a><a class="nav-link nav-item" href="../../../ITensorMPS/">ITensorMPS</a><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img alt="ITensors.jl logo" src="../assets/logo.png"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ITensors.jl</a></span></div><form action="../search.html" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><span class="tocitem">Getting Started with ITensor</span><ul><li><a class="tocitem" href="../getting_started/Installing.html">Installing Julia and ITensor</a></li><li><a class="tocitem" href="../getting_started/RunningCodes.html">Running ITensor and Julia Codes</a></li><li><a class="tocitem" href="../getting_started/NextSteps.html">Next Steps</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="DMRG.html">DMRG</a></li><li><a class="tocitem" href="QN_DMRG.html">Quantum Number Conserving DMRG</a></li><li class="is-active"><a class="tocitem" href="MPSTimeEvolution.html">MPS Time Evolution</a></li></ul></li><li><span class="tocitem">Code Examples</span><ul><li><a class="tocitem" href="../examples/ITensor.html">ITensor Examples</a></li><li><a class="tocitem" href="../examples/MPSandMPO.html">MPS and MPO Examples</a></li><li><a class="tocitem" href="../examples/DMRG.html">DMRG Examples</a></li><li><a class="tocitem" href="../examples/Physics.html">Physics (SiteType) System Examples</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../IndexType.html">Index</a></li><li><a class="tocitem" href="../IndexSetType.html">Index collections</a></li><li><a class="tocitem" href="../ITensorType.html">ITensor</a></li><li><a class="tocitem" href="../MPSandMPO.html">MPS and MPO</a></li><li><a class="tocitem" href="../QN.html">QN</a></li><li><a class="tocitem" href="../SiteType.html">SiteType and op, state, val functions</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">DMRG</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DMRG.html">DMRG</a></li><li><a class="tocitem" href="../Sweeps.html">Sweeps</a></li><li><a class="tocitem" href="../ProjMPO.html">ProjMPO</a></li><li><a class="tocitem" href="../ProjMPOSum.html">ProjMPOSum</a></li><li><a class="tocitem" href="../Observer.html">Observer System for DMRG</a></li><li><a class="tocitem" href="../DMRGObserver.html">DMRGObserver</a></li></ul></li><li><a class="tocitem" href="../OpSum.html">OpSum (AutoMPO)</a></li></ul></li><li><span class="tocitem">Frequently Asked Questions</span><ul><li><a class="tocitem" href="../faq/JuliaAndCpp.html">Programming Language (Julia, C++, ...) FAQs</a></li><li><a class="tocitem" href="../faq/DMRG.html">DMRG FAQs</a></li><li><a class="tocitem" href="../faq/Development.html">ITensor Development FAQs</a></li></ul></li><li><span class="tocitem">Upgrade guides</span><ul><li><a class="tocitem" href="../UpgradeGuide_0.1_to_0.2.html">Upgrading from 0.1 to 0.2</a></li></ul></li><li><a class="tocitem" href="../Einsum.html">ITensor indices and Einstein notation</a></li><li><span class="tocitem">Advanced usage guide</span><ul><li><a class="tocitem" href="../AdvancedUsageGuide.html">Advanced usage guide</a></li><li><a class="tocitem" href="../Multithreading.html">Multithreading</a></li><li><a class="tocitem" href="../QNTricks.html">Symmetric (QN conserving) tensors: background and usage</a></li><li><a class="tocitem" href="../CodeTiming.html">Timing and profiling</a></li><li><a class="tocitem" href="../ContractionSequenceOptimization.html">Contraction sequence optimization</a></li><li><a class="tocitem" href="../HDF5FileFormats.html">HDF5 File Formats</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="MPSTimeEvolution.html">MPS Time Evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="MPSTimeEvolution.html">MPS Time Evolution</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ITensor/ITensors.jl/blob/master/docs/src/tutorials/MPSTimeEvolution.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="MPS-Time-Evolution"><a class="docs-heading-anchor" href="#MPS-Time-Evolution">MPS Time Evolution</a><a id="MPS-Time-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#MPS-Time-Evolution" title="Permalink"></a></h1><p>An important application of <a href="https://tensornetwork.org/mps/">matrix product state (MPS)</a>  tensor networks in physics is computing the time evolution of a quantum state under the dynamics of a Hamiltonian <span>$H$</span>. An accurate, efficient, and simple way to time evolve a matrix product state (MPS) is by using a Trotter decomposition of the time evolution operator <span>$U(t) = e^{-i H t}$</span>.</p><p>The technique we will use is "time evolving block decimation" (TEBD).  More simply it is just the idea of decomposing the time-evolution operator into a circuit of quantum 'gates' (two-site unitaries) using the Trotter-Suzuki approximation and applying these gates in a controlled way to an MPS.</p><p>Let's see how to set up and run a TEBD calculation using ITensor.</p><p>The Hamiltonian <span>$H$</span> we will use is the one-dimensional Heisenberg model which is given by:</p><p class="math-container">\[\begin{aligned}
H &amp; = \sum_{j=1}^{N-1} \mathbf{S}_{j} \cdot \mathbf{S}_{j+1}  \\
&amp; = \sum_{j=1}^{N-1} S^z_{j} S^z_{j+1} + \frac{1}{2} S^+_{j} S^-_{j+1} + \frac{1}{2} S^-_{j} S^+_{j+1}
\end{aligned} \]</p><p><strong>The TEBD Method</strong></p><p>When the Hamiltonian, like the one above, is a sum of local terms,</p><p class="math-container">\[H = \sum_j h_{j,j+1}\]</p><p>where <span>$h_{j,j+1}$</span> acts on sites j and j+1, then a Trotter decomposition that is particularly well suited for use with MPS techniques is</p><p class="math-container">\[e^{-i \tau H} \approx e^{-i h_{1,2} \tau/2} e^{-i h_{2,3} \tau/2} \cdots e^{-i h_{N-1,N} \tau/2}
e^{-i h_{N-1,N} \tau/2} e^{-i h_{N-2,N-1} \tau/2} \cdots e^{-i h_{1,2} \tau/2} + O(\tau^3)\]</p><p>Note the factors of two in each exponential. Each factored exponential is known as a Trotter "gate".</p><p>We can visualize the resulting circuit that will be applied to the MPS as follows:</p><p><img alt="" src="trotter_tevol.png"/></p><p>The error in the above decomposition is of order <span>$\tau^3$</span>, so that will be the error accumulated <em>per time step</em>. Because of the time-step error, one takes <span>$\tau$</span> to be small and then applies the above set of operators to an MPS as a single sweep, then does a number <span>$(t/\tau)$</span> of sweeps to evolve for a total time <span>$t$</span>. The total error will therefore scale as <span>$\tau^2$</span> with this scheme, though other sources of error may dominate for long times, or very small <span>$\tau$</span>, such as truncation errors.</p><p>Let's take a look at the code to apply these Trotter gates to an MPS to time evolve it. Then we will break down the steps of the code in more detail.</p><p><strong>ITensor TEBD Time Evolution Code</strong></p><p>Let's look at an entire, working ITensor code that will do this calculation then discuss the main steps. (If you need help running the code below, see the getting started page on running ITensor codes.)</p><pre><code class="language-julia">using ITensors

let
  N = 100
  cutoff = 1E-8
  tau = 0.1
  ttotal = 5.0

  # Compute the number of steps to do
  Nsteps = Int(ttotal/tau)

  # Make an array of 'site' indices
  s = siteinds("S=1/2",N;conserve_qns=true)

  # Make gates (1,2),(2,3),(3,4),...
  gates = ITensor[]
  for j=1:N-1
    s1 = s[j]
    s2 = s[j+1]
    hj =       op("Sz",s1) * op("Sz",s2) +
         1/2 * op("S+",s1) * op("S-",s2) +
         1/2 * op("S-",s1) * op("S+",s2)
    Gj = exp(-1.0im * tau/2 * hj)
    push!(gates,Gj)
  end
  # Include gates in reverse order too
  # (N,N-1),(N-1,N-2),...
  append!(gates,reverse(gates))

  # Initialize psi to be a product state (alternating up and down)
  psi = productMPS(s, n -&gt; isodd(n) ? "Up" : "Dn")

  c = div(N,2) # center site

  # Compute and print initial &lt;Sz&gt; value on site c
  t = 0.0
  Sz = expect(psi,"Sz";site_range=c:c)
  println("$t $Sz")

  # Do the time evolution by applying the gates
  # for Nsteps steps and printing &lt;Sz&gt; on site c
  for step=1:Nsteps
    psi = apply(gates, psi; cutoff=cutoff)
    t += tau
    Sz = expect(psi,"Sz";site_range=c:c)
    println("$t $Sz")
  end

  return
end</code></pre><p><strong>Steps of The Code</strong></p><p>After setting some parameters, like the system size N and time step <span>$\tau$</span> to use, we compute the number of time evolution steps <code>Nsteps</code> that will be needed.</p><p>The line <code>s = siteinds("S=1/2",N;conserve_qns=true)</code> defines an array of  spin 1/2 tensor indices (Index objects) which will be the site or physical indices of the MPS.</p><p>Next we make an empty array <code>gates = ITensor[]</code> that will hold ITensors  that will be our Trotter gates. Inside the <code>for n=1:N-1</code> loop that follows the lines</p><pre><code class="language-julia">hj =      op("Sz",s1) * op("Sz",s2) +
    1/2 * op("S+",s1) * op("S-",s2) +
    1/2 * op("S-",s1) * op("S+",s2)</code></pre><p>call the <code>op</code> function which reads the "S=1/2" tag on our site indices (sites j and j+1) and which then knows that we want the spin 1/ 2 version of the "Sz", "S+", and "S-" operators.  The <code>op</code> function returns these operators as ITensors and we  tensor product and add them together to compute the operator <span>$h_{j,j+1}$</span> defined as</p><p class="math-container">\[h_{j,j+1} = S^z_j S^z_{j+1} + \frac{1}{2} S^+_j S^-_{j+1} + \frac{1}{2} S^-_j S^+_{j+1} \]</p><p>which we call <code>hj</code> in the code.</p><p>To make the corresponding Trotter gate <code>Gj</code> we exponentiate <code>hj</code> times a factor <span>$-i \tau/2$</span> and then append or push this onto the end of the gate array <code>gates</code>.</p><pre><code class="language-julia">Gj = exp(-1.0im * tau/2 * hj)
push!(gates,Gj)</code></pre><p>Having made the gates for bonds (1,2),(2,3),(3,4), etc. we still need to append the gates in reverse order to complete the correct Trotter formula. Here we can conveniently do that by just calling the Julia <code>append!</code> function and supply a reversed version of the array of gates we have made so far. This can be done in a single line of code <code>append!(gates,reverse(gates))</code>.</p><p>So that the code produces interesting output, we define a function called <code>measure_Sz</code> that we will pass our MPS into and which will return the expected value of <span>$S^z$</span> on a given site, which we will take to be near the center of the MPS. The details of this  function are outside the scope of this tutorial, but are explained in the example code for measuring MPS.</p><p>The line of code <code>psi = productMPS(s, n -&gt; isodd(n) ? "Up" : "Dn")</code> initializes our MPS <code>psi</code> as a product state of alternating  up and down spins. We call <code>measure_Sz</code> before starting the time evolution.</p><p>Finally, to carry out the time evolution we loop over the step number <code>for step=1:Nsteps</code> and during each step call the function </p><pre><code class="language-julia">psi = apply(gates, psi; cutoff=cutoff)</code></pre><p>which applies the array of ITensors called <code>gates</code> to our current MPS <code>psi</code>, truncating the MPS at each step using the truncation error threshold supplied as the variable <code>cutoff</code>. </p><p>The <code>apply</code> function is smart enough to determine which site indices each gate has, and then figure out where to apply it to our MPS. It automatically handles truncating the MPS and can even handle non-nearest-neighbor gates, though that  feature is not used in this example.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="QN_DMRG.html">« Quantum Number Conserving DMRG</a><a class="docs-footer-nextpage" href="../examples/ITensor.html">ITensor Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Wednesday 22 September 2021 22:27">Wednesday 22 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>